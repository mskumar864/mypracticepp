<!DOCTYPE html>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://www.paypalobjects.com/api/checkout.js"></script>
</head>

<body>
<div id="paypal-button-container"></div>

<script>
    paypal.Button.render({

        env: 'sandbox', // sandbox | production

        // Show the buyer a 'Pay Now' button in the checkout flow
        commit: false,

        // payment() is called when the button is clicked
        payment: function() {

            // Set up a url on your server to create the payment
         var CREATE_URL = 'http://localhost:8081/create';
            //   var CREATE_URL = 'http://localhost:8080/createpayment';
            // Make a call to your server to set up the payment
            return paypal.request.get(CREATE_URL)
                .then(function(res) {


                    return res.id;
                });
        },

        // onAuthorize() is called when the buyer approves the payment
        onAuthorize: function(data, actions) {

            // Set up a url on your server to execute the payment
            var EXECUTE_URL = '/execute';

            // Set up the data you need to pass to your server
            var data = {
                paymentID: data.paymentID,
                payerID: data.payerID
            };
            console.log("Console Data", data)

            // Make a call to your server to execute the payment
           // return paypal.request.post("http://localhost:8081/execute", data)
            return paypal.request.post("http://localhost:8080/execute", data)
                .then(function (res) {


                 alert('Payment Complete!');


              //     actions.redirect();
                    //actions.redirect("/confirmation");

                });
        },
        onCancel: function(data, actions) {
          console.log("cancelled");
        },

        onError: function(err) {
            /*
             * An error occurred during the transaction
             */
            console.log("error"+err);
        }

    }, '#paypal-button-container');
</script>
</body>
